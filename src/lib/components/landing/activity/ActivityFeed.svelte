<script lang="ts">
	import { Megaphone, Shield, AtSign } from 'lucide-svelte';
	import type { Template } from '$lib/types/template';

	export let templates: Template[];
	export let messageCount: number;

	const activityTypes = {
		certified: {
			icon: Shield,
			iconClass: 'text-green-500',
			textClass: 'text-green-600 sm:text-base text-sm',
			label: 'Certified Delivery'
		},
		direct: {
			icon: AtSign,
			iconClass: 'text-blue-500',
			textClass: 'text-blue-600 sm:text-base text-sm',
			label: 'Direct Outreach'
		}
	};

	let itemsToShow = 2;

	// function updateItemsToShow() {
	//     itemsToShow = window.innerWidth >= 640 ? 3 : 2;
	// }

	// $: if (typeof window !== 'undefined') {
	//     window.addEventListener('resize', updateItemsToShow);
	//     updateItemsToShow();
	// }
</script>

<div class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
	<div class="mb-6 flex items-center justify-between">
		<div class="flex items-center gap-3">
			<Megaphone class="h-5 w-5 text-slate-600" />
			<h3 class="text-sm font-medium text-slate-900 sm:text-base">Recent Messages</h3>
		</div>
		<span class="text-xs text-slate-500 sm:text-sm">Latest Activity</span>
	</div>

	<div class="space-y-4">
		{#each templates.slice(0, itemsToShow) as template (template.id)}
			{@const activity = activityTypes[template.type]}
			<div
				class="flex items-center justify-between rounded-lg border border-slate-100 bg-slate-50 p-3 text-xs sm:text-sm"
			>
				<div class="flex items-center gap-3">
					<svelte:component this={activity.icon} class="h-4 w-4 {activity.iconClass}" />
					<div>
						<div class="text-xs font-medium sm:text-sm">
							<span class={activity.textClass}>
								{activity.label}
							</span>
						</div>
						<div class="text-slate-900">{template.title}</div>
						<div class="text-xs text-slate-500 sm:text-sm">
							{template.type === 'certified' ? template.metrics.districts : template.metrics.reach}
						</div>
					</div>
				</div>
			</div>
		{/each}
	</div>
</div>

# ====================================
# CORE CONFIGURATION
# ====================================

# Database (Required)
DATABASE_URL="postgres://root:mysecretpassword@localhost:5432/local"
SUPABASE_DATABASE_URL=postgresql://user:password@db.supabase.co:5432/postgres

# Congressional Web Contact API (Required)
CWC_API_KEY=your-cwc-api-key
CWC_CAMPAIGN_ID=communique-2025

# CWC Delivery Agent Configuration (CommuniquÃ© PBC)
CWC_DELIVERY_AGENT_ID=COMMUNIQUE_PBC
CWC_DELIVERY_AGENT_NAME="CommuniquÃ© PBC"
CWC_DELIVERY_AGENT_CONTACT=contact@communi.email
CWC_DELIVERY_AGENT_ACKNOWLEDGEMENT_EMAIL=noreply@communi.email
CWC_DELIVERY_AGENT_ACK=Y

# ====================================
# N8N WORKFLOW CONFIGURATION
# ====================================

# N8N Instance Configuration
N8N_INSTANCE_URL=https://your-instance.app.n8n.cloud
N8N_API_KEY=your-n8n-api-key
N8N_WEBHOOK_SECRET=demo-secret
N8N_WEBHOOK_BASE_URL=https://your-instance.app.n8n.cloud/webhook

# CommuniquÃ© API
COMMUNIQUE_API_URL=https://api.communi.email

# ====================================
# VOTER PROTOCOL INTEGRATION (NEAR + Scroll Testnet)
# ====================================

# NEAR Testnet Configuration
NEAR_NETWORK_ID=testnet
NEAR_NODE_URL=https://rpc.testnet.near.org
NEAR_MPC_CONTRACT=v1.signer.testnet

# Web3Auth (OAuth â†’ MPC Wallet)
WEB3AUTH_CLIENT_ID=your-web3auth-client-id
WEB3AUTH_NETWORK=testnet

# ðŸ”’ PRIVACY: Account ID Generation
# CRITICAL: Generate a random 256-bit salt and keep it secret
# This prevents linking account IDs to real identities
# Command to generate: openssl rand -hex 32
NEAR_ACCOUNT_SALT=your-random-256-bit-salt-here-keep-secret

# Scroll Sepolia Testnet
SCROLL_RPC_URL=https://sepolia-rpc.scroll.io
SCROLL_CHAIN_ID=534351
SCROLL_EXPLORER=https://sepolia.scrollscan.com

# Smart Contract Addresses (Deploy to Scroll Sepolia)
VOTER_TOKEN_ADDRESS=0x... # VOTERToken ERC20
DISTRICT_GATE_ADDRESS=0x... # ZK proof verifier
REPUTATION_REGISTRY_ADDRESS=0x... # ERC-8004 reputation

# Certification Settings
ENABLE_CERTIFICATION=true

# ====================================
# AGENT CONFIGURATION
# ====================================

# Multi-Agent Consensus APIs (REQUIRED for moderation)
OPENAI_API_KEY=your-openai-api-key-here  # For FREE moderation API + GPT-5
GEMINI_API_KEY=your-gemini-api-key-here  # For Gemini 2.5 Flash-Lite ($0.10/1M) + Embeddings (FREE tier!)
ANTHROPIC_API_KEY=your-anthropic-api-key  # For Claude 3.5 Haiku (tie-breaker)

# Gemini API Key (Get from: https://aistudio.google.com/apikey)
# - Used for: Text embeddings (gemini-embedding-001) + Agent moderation
# - FREE tier: Unlimited requests in Google AI Studio
# - Paid tier: $0.15 per 1M tokens (embeddings), $0.10 per 1M tokens (moderation)
# - Key format: AIza... (40 characters)

# Agent Service URLs
VERIFICATION_AGENT_URL=http://localhost:8001
SUPPLY_AGENT_URL=http://localhost:8002
MARKET_AGENT_URL=http://localhost:8003
IMPACT_AGENT_URL=http://localhost:8004
REPUTATION_AGENT_URL=http://localhost:8005

# Moderation Settings
DAILY_COST_LIMIT=50  # Daily AI cost limit in USD
MONTHLY_COST_LIMIT=500  # Monthly AI cost limit in USD
CONSENSUS_TYPE=multi_agent  # 'multi_agent' or 'single' (fallback)

# ====================================
# BLOCKCHAIN CONFIGURATION (Optional)
# ====================================

# ðŸ”’ SECURITY: NO PRIVATE KEYS ON SERVER
# All transaction signing happens CLIENT-SIDE with user passkeys.
# The server is READ-ONLY for blockchain state queries.

# Scroll zkEVM RPC (Ethereum L2 settlement)
SCROLL_RPC_URL=https://rpc.scroll.io

# ðŸ”¥ REMOVED: SCROLL_PRIVATE_KEY - NO KEYS ON SERVER

# Contract Addresses (READ-ONLY)
VOTER_REGISTRY_ADDRESS=0x...
VOTER_TOKEN_ADDRESS=0x...
COMMUNIQUE_CORE_ADDRESS=0x...
AGENT_CONSENSUS_ADDRESS=0x...

# ====================================
# IDENTITY VERIFICATION (Phase 1A)
# ====================================

# ðŸ”’ CRITICAL: Identity Hash Salt (Sybil Resistance)
# Generate with: openssl rand -hex 32
# NEVER regenerate in production (requires data migration)
IDENTITY_HASH_SALT=your-64-char-hex-salt-here-keep-secret-never-regenerate

# ðŸ”’ IP Hash Salt (Fraud Detection)
# Generate with: openssl rand -hex 32
# Rotates daily (can be regenerated safely)
IP_HASH_SALT=your-64-char-hex-salt-here-keep-secret-safe-to-regenerate

# self.xyz SDK Configuration (FREE tier - no API key required)
# self.xyz uses on-chain verification, not API keys
NEXT_PUBLIC_SELF_APP_NAME=CommuniquÃ©
NEXT_PUBLIC_SELF_SCOPE=communique-congressional
NEXT_PUBLIC_SELF_ENDPOINT=https://communi.email/api/identity/verify
SELF_MOCK_PASSPORT=false  # Set to 'true' for development/testing

# Didit.me SDK Configuration (FREE tier)
DIDIT_API_KEY=your-didit-api-key-here
DIDIT_APP_ID=your-didit-app-id-here
DIDIT_WEBHOOK_SECRET=your-didit-webhook-secret-here  # For HMAC signature verification

# ====================================
# FEATURE FLAGS (Optional)
# ====================================

# Enable beta features
ENABLE_BETA=false

# Enable challenge markets
ENABLE_CHALLENGE_MARKETS=true

# Enable supply optimization
ENABLE_SUPPLY_OPTIMIZATION=true

# ====================================
# MONITORING & NOTIFICATIONS (Optional)
# ====================================

# Slack Notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
SLACK_CHANNEL=#n8n-deployments

# ====================================
# DEVELOPMENT SETTINGS
# ====================================

# Node Environment
NODE_ENV=development

# Server Configuration
PORT=5173
HOST=localhost

# Debug Settings
DEBUG=communique:*
LOG_LEVEL=info

# ====================================
# EXPORT SETTINGS (for scripts)
# ====================================

# Export inactive workflows
EXPORT_INACTIVE=false

# Target environment for deployment
ENVIRONMENT=production

# ====================================
# FLY.IO N8N DEPLOYMENT
# ====================================

# Fly.io Configuration
FLY_APP_NAME=communique-n8n
FLY_REGION=iad
FLY_VOLUME_SIZE=10
FLY_API_TOKEN=your-fly-api-token

# Fly.io N8N Instance
FLYIO_N8N_URL=https://communique-n8n.fly.dev
FLYIO_N8N_API_KEY=your-n8n-api-key
FLYIO_N8N_WEBHOOK_SECRET=shared-webhook-secret

# N8N Authentication
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=secure-password-here
N8N_ENCRYPTION_KEY=generate-32-char-random-string
N8N_JWT_SECRET=generate-jwt-secret-here

# ====================================
# EMBEDDED DELIVERY SERVICE (SMTP Server)
# ====================================

# SMTP Server Configuration
SMTP_HOST=0.0.0.0
SMTP_PORT=587

# Optional: SMTP for N8N emails
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_SENDER=your-email@gmail.com
SMTP_SSL=true

# Optional: S3 for backups
AWS_S3_BUCKET=your-backup-bucket
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_DEFAULT_REGION=us-east-1

# ====================================
# TEE CONFIGURATION (Week 13-14)
# ====================================

# ðŸ”’ CRITICAL: XChaCha20-Poly1305 Encryption
# Generate with: openssl rand -hex 32
# NEVER regenerate in production (requires key migration)
ENCRYPTION_KEY=your-64-char-hex-encryption-key-here-keep-secret-never-regenerate

# TEE Provider Selection (aws | gcp | azure | mock)
# PRIMARY: AWS Nitro Enclaves (ARM Graviton, no Intel ME/AMD PSP, independently audited)
TEE_PROVIDER=aws

# ====================================
# AWS NITRO ENCLAVES (PRIMARY - Phase 1)
# ====================================
#
# Security advantages:
# - No Intel ME or AMD PSP (ARM Graviton architecture)
# - Hypervisor-based isolation (trust AWS, not CPU vendor)
# - Independently audited (August 2025)
# - Open-source Nitro components for inspection
# - Cost: 15-30% cheaper than GCP ($55-60/month vs $60-85/month)
# - FREE tier: 750 hrs/month on t4g.small through Dec 2025
#
# Security caveat: While AWS Nitro avoids x86 management engines,
# absolute certainty about NSA backdoors is impossible. ARM architecture
# + auditable components reduce but don't eliminate state-actor risk.

# AWS Region (us-east-1 recommended for cost + CWC proximity)
AWS_REGION=us-east-1

# AWS Account ID (12-digit account number)
AWS_ACCOUNT_ID=123456789012

# AWS Credentials (optional if using IAM roles)
# AWS_ACCESS_KEY_ID=your-access-key-id
# AWS_SECRET_ACCESS_KEY=your-secret-access-key

# Nitro Enclave Instance Type (ARM Graviton with Nitro Enclaves support)
# Options: c6g.large (2vCPU, 4GB), c6g.xlarge (4vCPU, 8GB), c7g.large, m6g.large, r6g.large
# FREE tier: t4g.small (2vCPU, 2GB) - 750 hrs/month through Dec 2025
AWS_NITRO_INSTANCE_TYPE=c6g.large

# VPC Configuration
AWS_VPC_ID=vpc-0123456789abcdef0
AWS_SUBNET_ID=subnet-0123456789abcdef0
AWS_SECURITY_GROUP_IDS=sg-0123456789abcdef0,sg-0123456789abcdef1

# IAM Instance Profile (for EC2 parent instance)
AWS_IAM_INSTANCE_PROFILE=CommuniqueTEEInstanceProfile

# Enclave Image Storage
AWS_ENCLAVE_BUCKET=communique-nitro-enclaves
AWS_ENCLAVE_IMAGE_KEY=enclaves/communique-tee.eif

# Nitro Enclave Configuration
AWS_NITRO_ENCLAVE_CID=16  # Context ID for vsock communication
AWS_NITRO_ENCLAVE_PORT=5000  # Vsock port for enclave communication
AWS_NITRO_VSOCK_PROXY_PORT=8080  # Parent instance proxy port (external access)

# TEE Container Configuration (ECR)
TEE_CONTAINER_IMAGE=123456789012.dkr.ecr.us-east-1.amazonaws.com/communique-tee:latest
TEE_CONTAINER_DIGEST=sha256:...  # Generated after building container

# TEE Instance Configuration
TEE_INSTANCE_CPU=2  # CPU cores allocated to enclave
TEE_INSTANCE_MEMORY_GB=4  # Memory allocated to enclave (in GB)
TEE_ENDPOINT=https://tee.communi.email  # Public TEE endpoint

# ====================================
# GCP CONFIDENTIAL SPACE (DEPRECATED - Fallback only)
# ====================================
#
# DEPRECATED: Kept for fallback only. Use AWS Nitro Enclaves for new deployments.
# Reason: AMD PSP present (proprietary firmware), higher cost, no independent audit.

# GCP Configuration (DEPRECATED)
# GCP_PROJECT_ID=communique-production
# GCP_REGION=us-central1
# GCP_SERVICE_ACCOUNT_EMAIL=tee-workload@communique-production.iam.gserviceaccount.com
# GCP_WORKLOAD_IDENTITY_POOL_ID=communique-tee-pool
# GCP_WORKLOAD_IDENTITY_PROVIDER_ID=communique-tee-provider

# GCP Container Image (DEPRECATED)
# GCP_CONTAINER_IMAGE=gcr.io/communique-production/communique-tee:latest
# GCP_CONTAINER_DIGEST=sha256:...

# ====================================
# AZURE CONFIDENTIAL VMs (Future)
# ====================================

# Azure Configuration (Future)
# AZURE_SUBSCRIPTION_ID=your-subscription-id
# AZURE_RESOURCE_GROUP=communique-tee
# AZURE_REGION=eastus2
# AZURE_ATTESTATION_ENDPOINT=https://sharedeus2.eus2.attest.azure.net

# TEE Security Settings
TEE_ENABLE_ATTESTATION_VERIFICATION=true  # Verify attestation tokens (REQUIRED in production)
TEE_EXPECTED_CODE_HASH=sha256:...  # Expected container image digest (updated after deployment)
TEE_MAX_PAYLOAD_SIZE_MB=10  # Maximum encrypted payload size (default: 10MB)

# TEE Monitoring
TEE_HEALTH_CHECK_INTERVAL_SECONDS=30  # Health check frequency (default: 30s)
TEE_METRICS_ENDPOINT=http://localhost:8080/metrics  # Prometheus metrics endpoint
